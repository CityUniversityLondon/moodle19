GTLib.Widget.Dialog=function(title,prompt,opts){this.x;this.y;this.w=300;this.h=200;this.title;this.prompt;this.buttons;this.id;this.domObj;this.preInitFunct;this.postInitFunct;this.preCloseClickFunct;this.postCloseClickFunct;this.preCloseFunct;this.postCloseFunct;this.postResizeFunct;this.lightBox;this.showXY=false;this.constrain=false;this.cssTheme="standard";this.zIndex;this.ldText='Please wait. Loading Data...';this.children=new Array();this.parentDialog;this.tbButtons={close:true,minmax:true};this.browser={ie:navigator.appVersion.indexOf('MSIE')>-1,ie6:navigator.appVersion.indexOf('MSIE 6')>-1,opera:navigator.userAgent.indexOf("Opera")>-1,firefox:navigator.userAgent.indexOf("Firefox")>-1};this._winDets;this._ddResize;this.Init=function(){if(me.id!=""&&$GT(me.id)){return(false);}
GTLib.Base.ObjectPropsFromOptions(me,opts);if(typeof(me.preInitFunct)=='function'){me.preInitFunct();}
me.updateWinDets();me.x=opts.x?opts.x:(parseInt(me._winDets.w)/2)-(parseInt(me.w)/2)+parseInt(me._winDets.x);me.y=opts.y?opts.y:(parseInt(me._winDets.y)+parseInt(me._winDets.h/2))-(parseInt(me.h)/2);me.title=title;me.prompt=prompt;me.buttons=typeof(opts.buttons)!='undefined'?opts.buttons:[{}];if(!me.zIndex){var tdia=me.getTopmostDialog();if(tdia){me.zIndex=tdia.zIndex+1;}else{me.zIndex=999;}}
if(typeof(GTLib_DialogTheme)!='undefined'){me.cssTheme=GTLib_DialogTheme;}
me.registerDialog();me.DrawDialog();if(typeof(me.postInitFunct)=='function'){me.postInitFunct();}
me.FixAllIEPngBGs();return(true);}
this.registerDialog=function(){if(typeof(GTLib.Widget.Dialogs)=='undefined'){GTLib.Widget.Dialogs=new Array();dlid=0;}else{dlid=GTLib.Widget.Dialogs.length;}
me.id=me.id?me.id:('dialog_'+dlid);GTLib.Widget.Dialogs[dlid]=me;}
this.unregisterDialog=function(){var apos=GTLib.Array.search(me,GTLib.Widget.Dialogs);if(apos==-1){return;}
GTLib.Widget.Dialogs.splice(apos,1);}
this.getTopmostDialog=function(lbox){var z=-1;var topdia=null;if(typeof(GTLib.Widget.Dialogs)=='undefined'){return(null);}
for(var d=0;d<GTLib.Widget.Dialogs.length;d++){var dia=GTLib.Widget.Dialogs[d];if(!lbox||dia.lightBox){if(dia.zIndex>=z){z=dia.zIndex;topdia=dia;}}}
return(topdia);}
this.updateWinDets=function(){var _winDets={x:YAHOO.util.Dom.getDocumentScrollLeft(),y:YAHOO.util.Dom.getDocumentScrollTop(),w:YAHOO.util.Dom.getViewportWidth(),h:YAHOO.util.Dom.getViewportHeight()};me._winDets=_winDets;return(_winDets);}
this.DrawDialog=function(){if(me.lightBox){var styleStr="left:0px;"+"top:0px;";if(this.browser.ie6){styleStr+="position:absolute!important;";var dh=YAHOO.util.Dom.getDocumentHeight();styleStr+="width:100%;height:"+dh+"px;";}else{styleStr+="position:fixed!important;";styleStr+="width:100%;height:100%;";}
styleStr+="z-index:"+(me.zIndex-1)+";";var darkDiv=$GT('darkDiv');if(!darkDiv){var darkDiv=GTLib.DOM.createEl('div',{id:'darkDiv',style:styleStr,'className':'lightBoxDarkDiv'});document.body.appendChild(darkDiv);}else{darkDiv.style.zIndex=me.zIndex;}}
var styleStr="";styleStr+="position:absolute;";styleStr+="left:"+me.x+"px;"+"top:"+me.y+"px;";styleStr+="width:"+me.w+"px;"+"height:"+me.h+"px;";var dialogContainer=GTLib.DOM.createEl('div',{id:me.id,style:styleStr});dialogContainer.style.zIndex=me.zIndex;me.domObj=dialogContainer;me.FixIE6FieldZIndexBug();var tlcorner=GTLib.DOM.createEl('div',{id:me.id+"_tlcorner",'className':'TopLeftCorner'});var trcorner=GTLib.DOM.createEl('div',{id:me.id+"_trcorner",'className':'TopRightCorner'});var blcorner=GTLib.DOM.createEl('div',{id:me.id+"_blcorner",'className':'BotLeftCorner'});var brcorner=GTLib.DOM.createEl('div',{id:me.id+"_brcorner",'className':'BotRightCorner'});dialogContainer.appendChild(tlcorner);dialogContainer.appendChild(trcorner);dialogContainer.appendChild(blcorner);dialogContainer.appendChild(brcorner);var toolBar=GTLib.DOM.createEl('div',{id:me.id+"_toolBar",'className':"DialogToolbar"});var toolBarTitle=GTLib.DOM.createEl('div',{id:me.id+"_toolBarTitle",'className':"DialogToolbarTitle"});toolBarTitle.innerHTML=me.title;toolBar.appendChild(toolBarTitle);var toolBarButtons=GTLib.DOM.createEl('div',{id:me.id+"_toolBarButtons",'className':"DialogToolbarButtons"});toolBar.appendChild(toolBarButtons);dialogContainer.appendChild(toolBar);var baseBar=GTLib.DOM.createEl('div',{id:me.id+"_baseBar",'className':"DialogBaseBar"});var baseBarInner=GTLib.DOM.createEl('div',{'className':"DialogBaseBarInner"});baseBar.appendChild(baseBarInner);dialogContainer.appendChild(baseBar);var dialogInner=GTLib.DOM.createEl('div',{id:me.id+"_inner",'className':'DialogInner'});dialogContainer.appendChild(dialogInner);var l_edge=GTLib.DOM.createEl('div',{id:me.id+"_l_edge",'className':'LeftEdge'});var r_edge=GTLib.DOM.createEl('div',{id:me.id+"_r_edge",'className':'RightEdge'});var b_edge=GTLib.DOM.createEl('div',{id:me.id+"_b_edge",'className':'BotEdge'});var t_edge=GTLib.DOM.createEl('div',{id:me.id+"_t_edge",'className':'TopEdge'});dialogContainer.appendChild(l_edge);dialogContainer.appendChild(r_edge);dialogContainer.appendChild(b_edge);dialogContainer.appendChild(t_edge);var prompt=GTLib.DOM.createEl('div',{id:me.id+"_prompt",'className':"DialogPrompt"});prompt.innerHTML=me.prompt;dialogInner.appendChild(prompt);var winDragContainer=GTLib.DOM.createEl('div',{id:me.id+"_winDragExpContainer",'className':"WindowDragExpContainer"});var winDrag=GTLib.DOM.createEl('div',{id:me.id+"_winDragExpander",'className':"WindowDragExpander"});winDrag.style.zIndex=(me.zIndex+1);winDragContainer.appendChild(winDrag);baseBar.appendChild(winDragContainer);this._ddResize=new GTLib.DD.ZIndex(me.id+"_winDragExpander","",{scroll:false,dragZ:me.zIndex+1});this._ddResize.onDrag=function(){me.Resize()};this._ddResize.setHandleElId(me.id+"_winDragExpander");if(me.showXY){var coords=GTLib.DOM.createEl('div',{id:me.id+"_coords",'className':"DialogCoords"});var posX=GTLib.DOM.createEl('div',{id:me.id+"_posX",'className':"PosX"});var posY=GTLib.DOM.createEl('div',{id:me.id+"_posY",'className':"PosY"});var sizeX=GTLib.DOM.createEl('div',{id:me.id+"_sizeX",'className':"SizeX"});var sizeY=GTLib.DOM.createEl('div',{id:me.id+"_sizeY",'className':"SizeY"});coords.appendChild(posX);coords.appendChild(posY);coords.appendChild(sizeX);coords.appendChild(sizeY);dialogInner.appendChild(coords);}
document.body.appendChild(dialogContainer);var dd=new GTLib.DD.ZIndex(dialogContainer.id,"",{scroll:false,dragZ:me.zIndex+1});dd.onDrag=function(){me.Moved()};dd.setHandleElId(me.id+"_toolBar");me.AddToolbarButtons();me.AddButtons(baseBar);dialogInner.style.height=(parseInt(dialogContainer.offsetHeight)-parseInt(toolBar.offsetHeight)-parseInt($GT(me.id+"_baseBar").offsetHeight))+"px";me.UpdateCoords();me.SetTheme(me.cssTheme);}
this.SetTheme=function(theme){me.cssTheme=theme;$GT(me.id).className=me.cssTheme+'_DW';setTimeout(function(){me.Resize()},5);if(GTLib.Browser.ie){setTimeout(function(){me.Resize()},100);}}
this.Moved=function(){if(me.constrain){var farX=parseInt(me.domObj.style.left)+parseInt(me.domObj.style.width);var farY=parseInt(me.domObj.style.top)+parseInt(me.domObj.style.height);if(farX<parseInt(me.domObj.style.width)){me.domObj.style.left="0px";}
if(farY<parseInt(me.domObj.style.height)){me.domObj.style.top="0px";}
if(farY>me._winDets.fullHeight){me.domObj.style.top=me._winDets.fullHeight-parseInt(me.domObj.style.height)+"px";}
if(this.browser.ie){var rPad=20;}else if(this.browser.opera){var rPad=10;}else if(this.browser.firefox){var rPad=4;}
if(farX>(me._winDets.fullWidth-rPad)){me.domObj.style.left=(me._winDets.fullWidth-parseInt(me.domObj.style.width))-rPad+"px";}
if(farY>me._winDets.fullHeight){me.domObj.style.top=me._winDets.fullHeight-parseInt(me.domObj.style.height);}}
me.UpdateCoords();}
this.Resize=function(){if(!$GT(me.id)){return;}
var toolBar=$GT(me.id+"_toolBar");var baseBar=$GT(me.id+"_baseBar");var winDrag=$GT(me.id+"_winDragExpander");var newWidth=parseInt(me.domObj.style.width)+parseInt(winDrag.offsetLeft);var newHeight=parseInt(me.domObj.style.height)+parseInt(winDrag.offsetTop);if(newWidth>50){me.domObj.style.width=newWidth+"px";}
if(newHeight>(toolBar.offsetHeight+baseBar.offsetHeight)){me.domObj.style.height=newHeight+"px";$GT(me.id+"_inner").style.height=(newHeight-parseInt($GT(me.id+"_toolBar").offsetHeight)-parseInt($GT(me.id+"_baseBar").offsetHeight))+"px";}
winDrag.style.left="0px";winDrag.style.top="0px";if(this._ddResize){this._ddResize.resetConstraints();}
me.UpdateCoords();me.SetEdgeDims();me.IE6ZIndexBugFrameResize();if(typeof(me.postResizeFunct)=='function'){me.postResizeFunct();}}
this.SetEdgeDims=function(){var dContDims=GTLib.DOM.getElDims(me.domObj);var tlc=$GT(me.id+"_tlcorner");var tlcDims=GTLib.DOM.getElDims(tlc);var trc=$GT(me.id+"_trcorner");var trcDims=GTLib.DOM.getElDims(trc);var blc=$GT(me.id+"_blcorner");var blcDims=GTLib.DOM.getElDims(blc);var brc=$GT(me.id+"_brcorner");var brcDims=GTLib.DOM.getElDims(brc);try{$GT(me.id+"_l_edge").style.height=((dContDims.h-tlcDims.h)-blcDims.h)+"px";$GT(me.id+"_l_edge").style.top=tlcDims.h+"px";$GT(me.id+"_r_edge").style.height=((dContDims.h-trcDims.h)-brcDims.h)+"px";$GT(me.id+"_r_edge").style.top=trcDims.h+"px";$GT(me.id+"_b_edge").style.width=((dContDims.w-blcDims.w)-brcDims.w)+"px";$GT(me.id+"_b_edge").style.left=blcDims.w+"px";$GT(me.id+"_t_edge").style.width=((dContDims.w-tlcDims.w)-trcDims.w)+"px";$GT(me.id+"_t_edge").style.left=tlcDims.w+"px";}catch(e){}}
this.UpdateCoords=function(){if(me.showXY){$GT(me.id+"_posX").innerHTML="x "+me.domObj.style.left;$GT(me.id+"_posY").innerHTML="y "+me.domObj.style.top;$GT(me.id+"_sizeX").innerHTML="w "+me.domObj.style.width;$GT(me.id+"_sizeY").innerHTML="h "+me.domObj.style.height;}}
this.AddToolbarButtons=function(){if(me.tbButtons.close){var closeBut=me.AddToolbarButton(me.id+"_close","DialogToolbarButton ButtonClose");if(typeof(me.preCloseClickFunct)=='function'){YAHOO.util.Event.addListener(closeBut,'click',function(){me.preCloseClickFunct()});}
YAHOO.util.Event.addListener(closeBut.id,'click',function(){me.CloseDialog()});if(typeof(me.postCloseClickFunct)=='function'){YAHOO.util.Event.addListener(closeBut,'click',function(){me.postCloseClickFunct()});}}
if(me.tbButtons.minmax){var maxBut=me.AddToolbarButton(me.id+"_maximise","DialogToolbarButton ButtonMax");YAHOO.util.Event.addListener(maxBut,'click',function(){me.MaximiseDialog()});var minBut=me.AddToolbarButton(me.id+"_minimise","DialogToolbarButton ButtonRest");minBut.style.display="none";YAHOO.util.Event.addListener(minBut,'click',function(){me.MinimiseDialog()});}}
this.AddToolbarButton=function(buttonId,buttonClass){var toolBarButtons=$GT(me.id+"_toolBarButtons");var but=GTLib.DOM.createEl('div',{id:buttonId,'className':buttonClass});YAHOO.util.Event.addListener(but,'mouseover',function(){me.IconButtonMouseOver(buttonId)});YAHOO.util.Event.addListener(but,'mouseout',function(){me.IconButtonMouseOut(buttonId)});toolBarButtons.appendChild(but);return(but);}
this.AddButtons=function(buttonParent){var butContainer=GTLib.DOM.createEl('div',{id:this.id+'_buttonContainer','className':'DialogButtonContainer'});buttonParent.appendChild(butContainer);for(var a=0;a<me.buttons.length;a++){var name=me.buttons[a].name;var butclass=me.buttons[a].butclass;var butstyle=me.buttons[a].butstyle?me.buttons[a].butstyle:'';if(typeof(butclass)=='undefined'){butclass='';}else{butclass=' '+butclass;}
var functCode=me.buttons[a].functCode;if(typeof(name)!='undefined'){var butId=me.buttons[a].butid?me.buttons[a].butid:me.id+"_button_"+a;var butInnerId=me.id+"_buttonInner_"+a;var but=GTLib.DOM.createEl('div',{id:butId,'className':'DialogButton'+butclass,style:butstyle});if(this.browser.ie6){but.style.width="20px";}
var butInner=GTLib.DOM.createEl('div',{id:butInnerId,'className':'DialogButtonInner'});butInner.innerHTML=name;but.appendChild(butInner);if(typeof(me.buttons[a].parent)=='undefined'){butContainer.appendChild(but);}else{$GT(me.buttons[a].parent).appendChild(but);}
this.AddButtonEvents(but,butId,butInnerId,functCode);}}}
this.AddButtonEvents=function(but,butId,butInnerId,cbClick){YAHOO.util.Event.addListener(but,'click',cbClick);YAHOO.util.Event.addListener(but,'mouseover',function(){me.ButtonMouseOver(butId,butInnerId)});YAHOO.util.Event.addListener(but,'mouseout',function(){me.ButtonMouseOut(butId,butInnerId)});}
this.ButtonMouseOver=function(butId,butInnerId){var but=$GT(butId);var butInner=$GT(butInnerId);but.className=but.className.replace('DialogButton','DialogButton_hover');butInner.className=butInner.className.replace('DialogButtonInner','DialogButtonInner_hover');}
this.ButtonMouseOut=function(butId,butInnerId){var but=$GT(butId);var butInner=$GT(butInnerId);but.className=but.className.replace("DialogButton_hover","DialogButton");butInner.className=butInner.className.replace("DialogButtonInner_hover","DialogButtonInner");}
this.IconButtonMouseOver=function(butId){var but=$GT(butId);but.className=but.className+"_hover";}
this.IconButtonMouseOut=function(butId){var but=$GT(butId);but.className=but.className.replace("_hover","");}
this.CloseDialog=function(){if(typeof(me.preCloseFunct)=='function'){var cont=me.preCloseFunct();}
if(cont==false){return(false);}
cont=me.CloseChildren();if(cont==false){return(false);}
me.unregisterDialog();topdia=me.getTopmostDialog(true);if(topdia!=null){var darkDiv=$GT('darkDiv');if(darkDiv){darkDiv.style.zIndex=topdia.zIndex;}}else{if(me.lightBox){me.RemoveDarkDiv();}}
me.RemoveDialogDiv();if(typeof(me.postCloseFunct)=='function'){me.postCloseFunct();}
this.DetatchFromParent();return(true);}
this.CloseChildren=function(){while(typeof(me.children[0])!='undefined'){var success=me.children[0].CloseDialog();if(!success){return(false);}}
return(true);}
this.MaximiseDialog=function(){this.updateWinDets();var hgt=(me._winDets.h)+"px";$GT(me.id).style.width="100%";$GT(me.id).style.height=hgt;this.IE6ZIndexBugFrameResize();var y=parseInt(me._winDets.y);$GT(me.id).style.left="0px";$GT(me.id).style.top=y+"px";$GT(me.id+"_maximise").style.display="none";$GT(me.id+"_minimise").style.display="";$GT(me.id+"_winDragExpContainer").style.display="none";$GT(me.id+"_inner").style.height=(parseInt($GT(me.id).offsetHeight)-parseInt($GT(me.id+"_toolBar").offsetHeight)-parseInt($GT(me.id+"_baseBar").offsetHeight))+"px";me.SetEdgeDims();if(typeof(me.postResizeFunct)=='function'){me.postResizeFunct();}}
this.MinimiseDialog=function(){$GT(me.id).style.width=me.w+"px";$GT(me.id).style.height=me.h+"px";$GT(me.id).style.left=me.x+"px";$GT(me.id).style.top=me.y+"px";$GT(me.id+"_minimise").style.display="none";$GT(me.id+"_maximise").style.display="";$GT(me.id+"_winDragExpContainer").style.display="";$GT(me.id+"_inner").style.height=(me.h-parseInt($GT(me.id+"_toolBar").offsetHeight)-parseInt($GT(me.id+"_baseBar").offsetHeight))+"px";me.SetEdgeDims();this.IE6ZIndexBugFrameResize();if(typeof(me.postResizeFunct)=='function'){me.postResizeFunct();}}
this.RemoveDialogDiv=function(){var div=me.domObj;div.style.visibility="hidden";try{var divParent=div.parentNode;divParent.removeChild(div);}catch(e){}}
this.RemoveDarkDiv=function(){if($GT('darkDiv')){$GT('darkDiv').style.visibility='hidden';document.body.removeChild($GT('darkDiv'));}}
this.SetPrompt=function(newPrompt){if(typeof(newPrompt)=="string"){$GT(me.id+"_prompt").innerHTML=newPrompt;}else{$GT(me.id+"_prompt").innerHTML='';$GT(me.id+"_prompt").appendChild(newPrompt);}}
this.SetTitle=function(newTitle){$GT(me.id+"_toolBarTitle").innerHTML=newTitle;}
this.StatusLoading=function(loadingText){if($GT(me.id+'_loader')){me.StatusLoadingRemove();}
var ldCont=GTLib.DOM.createEl('div',{id:this.id+'_loader','className':'mainLoader'});var ldTextNode=GTLib.DOM.createEl('div',{'style':'position:relative'});var ldImg=GTLib.DOM.createEl('div',{'className':'imgLoaderBar'});var ldText=loadingText?loadingText:this.ldText;ldTextNode.innerHTML=ldText;ldCont.appendChild(ldTextNode);ldCont.appendChild(ldImg,{});$GT(me.id+"_prompt").style.display='none';me.domObj.appendChild(ldCont);}
this.StatusLoadingRemove=function(){$GT(me.id+'_loader').parentNode.removeChild($GT(me.id+'_loader'));$GT(me.id+"_prompt").style.display='';}
this.RemoveButtons=function(){var butCont=$GT(this.id+'_buttonContainer');butCont.parentNode.removeChild(butCont);}
this.AddChildDialog=function(title,prompt,opts){var childNum=this.children.length;var opts=opts?opts:{};if(this.zIndex){opts.zIndex=this.zIndex+(this.children.length+1);}
var x=opts.x;var y=opts.y;var w=opts.w?opts.w:300;var h=opts.h?opts.h:200;var id=opts.id?opts.id:this.id+"_"+childNum;var lightbox=opts.lightbox?opts.lightbox:false;var tbButtons=opts.tbButtons?opts.tbButtons:{close:true,minmax:true};var buttons=opts.buttons?opts.buttons:[{}];var chPosOffset=10;if(x==null){var x=parseInt(YAHOO.util.Dom.getX(me.domObj))+(parseInt(me.domObj.offsetWidth/2)-parseInt(w/2))+(childNum*chPosOffset);}
if(y==null){var y=parseInt(YAHOO.util.Dom.getY(me.domObj))+(parseInt(me.domObj.offsetHeight/2)-parseInt(h/2))+(childNum*chPosOffset);}
opts.x=x;opts.y=y;var dg=new Dialog(title,prompt,opts);dg.id=id;dg.lightBox=lightbox;dg.tbButtons=tbButtons;var created=dg.Init();if(created){dg.parentDialog=me;this.children.push(dg);return(dg);}else{return(false);}}
this.DetatchFromParent=function(){if(me.parentDialog){var pKids=me.parentDialog.children;for(var p=0;p<pKids.length;p++){if(pKids[p].id==me.id){me.parentDialog.children.splice(p,1);return;}}}}
this.FixAllIEPngBGs=function(){this.FixIEPngBG($GT(me.id+"_t_edge"));this.FixIEPngBG($GT(me.id+"_r_edge"));this.FixIEPngBG($GT(me.id+"_b_edge"));this.FixIEPngBG($GT(me.id+"_l_edge"));this.FixIEPngBG($GT(me.id+"_tlcorner"));this.FixIEPngBG($GT(me.id+"_trcorner"));this.FixIEPngBG($GT(me.id+"_blcorner"));this.FixIEPngBG($GT(me.id+"_brcorner"));}
this.FixIEPngBG=function(elmnt){if((this.browser.ie6)&&(document.body.filters)){bkg=(elmnt.background?elmnt.background:(elmnt.style.backgroundImage?elmnt.style.backgroundImage:elmnt.currentStyle.backgroundImage));bkg=bkg.replace('url(','');bkg=bkg.replace(')','');while(bkg.indexOf('"')>-1){bkg=bkg.replace('"','');}
elmnt.style.backgroundImage="url(images/blank.gif)";elmnt.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+bkg+"', sizingMethod='scale');";}}
this.FixIE6FieldZIndexBug=function(){if(this.browser.ie6){var frame=GTLib.DOM.createEl('iframe',{id:this.id+'frame'});frame.style.position='absolute';frame.style.zIndex='0';frame.style.top='5px';frame.style.left='5px';var w=parseInt(this.domObj.style.width);var h=parseInt(this.domObj.style.height);frame.style.width=(w-10)+"px";frame.style.height=(h-10)+"px";frame.frameborder=0;this.domObj.appendChild(frame);}}
this.IE6ZIndexBugFrameResize=function(){if(this.browser.ie6){var w=this.domObj.offsetWidth>0?this.domObj.offsetWidth:this.domObj.style.width;var h=this.domObj.offsetHeight>0?this.domObj.offsetHeight:this.domObj.style.height;w=parseInt(w);h=parseInt(h);var frame=$GT(this.id+'frame');frame.style.width=(w-10)+"px";frame.style.height=(h-10)+"px";}}
var me=this;}
if(GTLib.ExportFuncs){Dialog=GTLib.Widget.Dialog;}